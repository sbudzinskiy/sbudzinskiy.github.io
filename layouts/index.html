{{ define "main" }}

{{ $profile := site.Data.profile }}
{{ $events := site.Data.events }}
{{ $pubs := site.Data.publications }}

<article class="first-entry home-info profile-split-layout">
    
    <div class="profile-left">
        {{ with $profile.image }}
        <img src="{{ . }}" alt="{{ $profile.name }}">
        {{ end }}
        
        <div class="profile-socials">
            <div class="social-icons">
                {{ range $profile.socials }}
                    {{ partial "social_item.html" . }}
                {{ end }}
            </div>
        </div>
    </div>

    <div class="profile-right">
        <header class="entry-header">
            <h2>{{ $profile.name }}</h2>
        </header>
        
        {{ partial "profile_intro.html" $profile }}
    </div>
</article>

{{ $upcoming := slice }}
{{ range $events }}
    {{ if ge (time .date) now }}
        {{ $upcoming = $upcoming | append . }}
    {{ end }}
{{ end }}

{{ if gt (len $upcoming) 0 }}
<div class="home-section">
    <h3>üóìÔ∏è Upcoming Events</h3>
    <ul class="simple-list">
        {{ range first 3 (sort $upcoming "date" "asc") }}
        <li>
            <strong>{{ (time .date).Format "Jan 02, 2006" }}:</strong> 
            {{ .title }} ‚Äî {{ .location }}
        </li>
        {{ end }}
    </ul>
</div>
{{ end }}

{{ if $pubs }}
<div class="home-section">
    <h3>üìù Recent Publications</h3>
    <ul class="paper-list">
        {{ range first 3 (sort $pubs "date" "desc") }}
        <li>
            <div class="paper-title">{{ .title | markdownify }}</div>
            <div class="paper-meta">
                <em>{{ .venue }}</em>
                <span class="paper-links">
                    {{ if .pdf }} | <a href="{{ .pdf }}">PDF</a>{{ end }}
                    {{ if .code }} | <a href="{{ .code }}">Code</a>{{ end }}
                </span>
            </div>
        </li>
        {{ end }}
    </ul>
</div>
{{ end }}

{{ end }}
